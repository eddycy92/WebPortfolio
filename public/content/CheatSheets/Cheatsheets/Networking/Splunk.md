# Splunk Interview Guide

## Overview
Splunk is a platform for searching, monitoring, and analyzing machine-generated data. It supports operations management, security, and compliance.

## Key Components
- **Splunk Enterprise**: Main platform.
- **Splunk Cloud**: Cloud-based version.
- **Splunk Light**: For smaller environments.
- **Splunk Hunk**: For Hadoop and NoSQL integration.

## Terminology

### Splunk-Specific Terms
- **Indexer**: 
  - Stores and indexes data. It processes incoming data, transforms it into events, and stores the events in indexes for efficient searching.
- **Search Head**: 
  - Enables data searches. It provides the interface and processing power to perform searches across indexed data.
- **Forwarder**: 
  - Collects and forwards logs. It sends data from various sources to the indexers for processing and storage.
- **Cluster**: 
  - Group of Splunk instances working together to provide high availability, load balancing, and data replication.
- **Knowledge Objects**: 
  - Enrich data with additional context (lookups, tags, event types, reports, dashboards, and alerts).

### Vendor-Neutral Terms
- **SIEM (Security Information and Event Management)**: 
  - Combines security information management (SIM) and security event management (SEM) to provide real-time analysis of security alerts generated by network hardware and applications.
- **Log Aggregation**: 
  - The process of collecting and centralizing log data from multiple sources into a single repository for analysis.
- **Data Correlation**: 
  - Analyzing relationships between different data sets to identify patterns, trends, and anomalies.
- **Anomaly Detection**: 
  - Identifying deviations from the norm in data to detect potential issues or threats.
- **Root Cause Analysis**: 
  - Investigating the underlying causes of issues or incidents to prevent recurrence and improve system stability.
- **Data Enrichment**: 
  - Enhancing raw data with additional information to provide more context and improve analysis.
- **Log Normalization**: 
  - Converting logs from different sources into a common format for easier analysis.
- **Alerting**: 
  - Automatically notifying users about specific conditions or events detected in the data.
- **Dashboards**: 
  - Visual displays of key metrics and data points to provide an overview of system performance and other important information.
- **Incident Response**: 
  - The process of identifying, managing, and mitigating security incidents.
- **Threat Intelligence**: 
  - Information about threats that can help organizations protect against cyber attacks.
- **Event Log**: 
  - A record of events, such as system activities, user actions, and security incidents, generated by software and hardware components.
- **Parsing**: 
  - The process of analyzing a string of symbols, either in natural language or in computer languages, to convert it into a format that is easier to process.
- **Retention Policy**: 
  - Guidelines for how long data should be stored before it is deleted or archived.

---

## Use Cases

### IT Operations
- **Infrastructure Monitoring**: 
	- Monitor servers, networks, and applications to ensure optimal performance and availability.
- **Log Management**: 
	- Collect and manage logs from various systems and applications for troubleshooting and auditing.
- **Capacity Planning**: Analyze usage trends to plan for future infrastructure needs.

### Security
- **Incident Detection and Response**: 
	- Identify and respond to security threats and incidents in real-time.
- **Compliance Monitoring**: 
	- Ensure adherence to regulatory requirements by monitoring and auditing logs and activities.
- **Threat Intelligence**: 
	- Integrate threat intelligence feeds to enhance detection and response capabilities.

### Business Analytics
- **Operational Insights**:
	- Gain insights into business operations by analyzing data from various sources.
- **User Behavior Analysis**: 
	- Understand user behavior and interactions to improve customer experience and optimize services.
- **Performance Metrics**:
	- Track and visualize key performance indicators (KPIs) to drive business decisions.

### Vendor-Neutral Terminology
- **SIEM (Security Information and Event Management)**: 
	- Combines security information management (SIM) and security event management (SEM) to provide real-time analysis of security alerts generated by network hardware and applications.
- **Log Aggregation**: 
	- The process of collecting and centralizing log data from multiple sources.
- **Data Correlation**: 
	- Analyzing relationships between different data sets to identify patterns and insights.
- **Anomaly Detection**: 
	- Identifying deviations from the norm to detect potential issues or threats.
- **Root Cause Analysis**: 
	- Investigating the underlying causes of issues or incidents to prevent recurrence.


---

## Data Onboarding

### Steps
1. **Inputs**: 
	Data ingestion from logs, metrics, etc.
2. **Parsing**: 
	Convert data into events.
3. **Indexing**: 
	Store data for search.

### Indexing
- **Use separate indexes**: 
	For different data sources to improve search performance and manage retention policies.

---

## SPL (Search Processing Language)

### Basic Commands
- **Basic Search**: `index=<index_name> <search_terms>`
- **Field Extraction**: `rex field=<field_name> "<regex_pattern>"`
- **Stats**: `stats count by <field_name>`
- **Timechart**: `timechart span=1h count`

### Filters and Data Manipulation
- **index**: `index=<index_name>`
- **source**: `source=<source_name>`
- **sourcetype**: `sourcetype=<source_type>`
- **eval**: Manipulate fields
- **stats**: Aggregate data
- **rex**: Extract fields
- **table**: Format results

### Advanced Searches
- **Search:** `index=<index_name> sourcetype=<source_type> "<search_query>"`
- **Example:** `index=syslog sourcetype=access_combined "error"`
- **Definition:** Search for logs in the specified index and sourcetype matching the query.

---

## CLI Commands

### Managing Splunk
- **Start Splunk:** 
    ```sh
    ./splunk start
    ```
- **Stop Splunk:** 
    ```sh
    ./splunk stop
    ```
- **Restart Splunk:** 
    ```sh
    ./splunk restart
    ```
- **Check Splunk Status:** 
    ```sh
    ./splunk status
    ```

### Index Management
- **List Indexes:** 
    ```sh
    ./splunk list index
    ```
- **Create Index:** 
    ```sh
    ./splunk add index <index_name>
    ```
- **Delete Index:** 
    ```sh
    ./splunk remove index <index_name>
    ```

### User Management
- **Add User:** 
    ```sh
    ./splunk add user <username> -role <role> -password <password>
    ```
- **Remove User:** 
    ```sh
    ./splunk remove user <username>
    ```

---

## API Examples

### Authentication
- **Obtain Session Key:** 
    ```sh
    curl -u <username>:<password> https://<splunk_server>:8089/services/auth/login -d username=<username> -d password=<password>
    ```

### Searching
- **Search:** 
    ```sh
    curl -k -u <username>:<password> https://<splunk_server>:8089/services/search/jobs -d search="search index=<index_name> <search_query>" -d earliest_time="rt-1h" -d latest_time="rt"
    ```

### Index Management
- **Create Index:** 
    ```sh
    curl -k -u <username>:<password> https://<splunk_server>:8089/services/data/indexes -d name=<index_name>
    ```

- **Delete Index:** 
    ```sh
    curl -k -u <username>:<password> https://<splunk_server>:8089/services/data/indexes/<index_name> -X DELETE
    ```

---

## Best Practices

### Indexing
- Use separate indexes for different data sources to improve search performance and manage retention policies.

### Data Normalization
- Implement the Common Information Model (CIM) to normalize data across different sources.

### Security
- Use Role-Based Access Control (RBAC) to manage user permissions.
- Encrypt data in transit and at rest.

### Performance Monitoring
- Regularly monitor system performance using built-in dashboards and set up alerts for any anomalies.
- Use summary indexing to precompute frequent searches and reduce load on the system.

### Backup and Recovery
- Schedule regular backups of Splunk configuration and indexed data.
- Test recovery procedures periodically to ensure data integrity and system availability.

### Logging and Troubleshooting
- Enable internal logging to capture system performance and user activities.
- Use `splunkd.log` for detailed logging information about the Splunk instance.

### Maintenance
- Regularly update Splunk to the latest version to benefit from new features and security patches.
- Clean up old and unnecessary data to maintain system efficiency.

---

## Procedures and Workflows

### Data Onboarding
1. **Configure Inputs:**
    ```sh
    ./splunk add monitor /var/log/
    ```
2. **Define Index:**
    ```sh
    ./splunk add index <index_name>
    ```
3. **Forward Data:**
    ```sh
    ./splunk add forward-server <splunk_server_ip>:9997
    ```

### Search Workflow
1. **Basic Search:**
    ```sh
    index=<index_name> <search_terms>
    ```
2. **Field Extraction:**
    ```sh
    rex field=<field_name> "<regex_pattern>"
    ```
3. **Aggregation:**
    ```sh
    stats count by <field_name>
    ```
4. **Timechart:**
    ```sh
    timechart span=1h count
    ```

### Index Management
1. **Create Index:**
    ```sh
    ./splunk add index <index_name>
    ```
2. **List Indexes:**
    ```sh
    ./splunk list index
    ```
3. **Delete Index:**
    ```sh
    ./splunk remove index <index_name>
    ```

### User Management
1. **Add User:**
    ```sh
    ./splunk add user <username> -role <role> -password <password>
    ```
2. **Remove User:**
    ```sh
    ./splunk remove user <username>
    ```

### API Usage
1. **Authenticate:**
    ```sh
    curl -u <username>:<password> https://<splunk_server>:8089/services/auth/login -d username=<username> -d password=<password>
    ```
2. **Create Index via API:**
    ```sh
    curl -k -u <username>:<password> https://<splunk_server>:8089/services/data/indexes -d name=<index_name>
    ```
3. **Search via API:**
    ```sh
    curl -k -u <username>:<password> https://<splunk_server>:8089/services/search/jobs -d search="search index=<index_name> <search_query>" -d earliest_time="rt-1h" -d latest_time="rt"
    ```
